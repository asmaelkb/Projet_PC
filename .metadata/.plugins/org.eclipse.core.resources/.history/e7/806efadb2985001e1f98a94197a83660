import java.util.concurrent.ArrayBlockingQueue;

public class ProdConsBuffer {
	int n; // Taille du tableau
	int nempty; // Nombre de cases vides
	int nfull; // Nombre de cases remplies
	
	public ProdConsBuffer(int n) {
		// Création d'un tableau vide
		this.n = n;
		this.nempty = n;
		this.nfull = 0;
		
		buffer = new ArrayBlockingQueue<Message>(n);
	}
	
	ArrayBlockingQueue<Message> buffer;
	// buffer à n entiers
	
	public void Producer(Message msg) {
		while (nfull == n) { // Aucune case vide <=> elles sont toutes remplies
			try {
				wait();
			} catch (InterruptedException e) {
				e.printStackTrace();
			}
		}
		buffer.add(msg);
		nempty--;
		nfull++;
		notifyAll();
	}
	
	public Message Consume() {
		while (nempty == n) { // Aucune case remplie <=> elles sont toutes vides
			try {
				wait();
			} catch (InterruptedException e) {
				e.printStackTrace();
			}
		}
		Message msg = buffer.remove();
		nempty++;
		nfull--;
		notifyAll();
		return msg;
	}
	
	
}
