package solutionSemaphore3;

import java.util.concurrent.Semaphore;

public class ProdConsBuffer {
	Semaphore notEmpty;
	Semaphore notFull;
	Semaphore mutex;
	int in;
	int out;
	
	ArrayBlockingQueue<Message> buffer;
 	
	public ProdConsBuffer() {
		this.in = 0;
		this.out = 0;
	}
	
	
	public void Produce(Message msg) throws InterruptedException {
		notFull.acquire();
		mutex.acquire();
		
		buffer[in] = msg;
		in = in + 1 % n;
		
		mutex.release();
		notEmpty.release();
	}
	
	public Message Consume() {
		notEmpty.acquire();
		mutex.acquire();
		
		Message msg = buffer[out];
		out = out + 1 % n;
		
		mutex.release();
		notFull.release();
	}
}
